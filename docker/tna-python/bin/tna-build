#!/bin/bash

set -e

echo "Running tna-build..."

if [ ! -f "/app/pyproject.toml" ]
then
  echo "pyproject.toml does not exist"
  exit 1
fi

if [ ! -f "/app/poetry.lock" ]
then
  echo "poetry.lock does not exist"
  exit 1
fi

poetry add "gunicorn=$WSGI_GUNICORN_VERSION"
poetry add "uvicorn=$ASGI_UVICORN_VERSION"
poetry install --no-root --no-interaction
